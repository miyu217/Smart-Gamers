<main>
  <p id="notice"><%= flash[:notice] %></p>
  <div class="container px-5 px-sm-0">
    <h1 class="heading-custom" data-en="Review">レビュー</h1>
    <div class="row">
      <div class="col-md-6">
        <section class="search mt-3">
          <div class="search-form-custom">
            <%= form_tag(search_path, method: "get", class: "form-inline") do %>
            <div class="input-group">
              <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "ゲームを検索" %>
              <div class="input-group-append">
                <button class="btn btn-search-custom text-light" type="submit"><i class="fa fa-search"></i></button>
              </div>
            </div>
            <% end %>
          </div>
        </section>
        <section class="game-date section-back mt-3">
          <div class="game-info-update text-end">
            <%= link_to edit_game_path(@game), class: 'btn btn-outline-dark rounded-pill btn-sm' do %>
              編集 <i class="fa-regular fa-pen-to-square"></i>
            <% end %>
          </div>
          <h3 class="ml-2 font-jp"><%= link_to @game.title, game_path(@game) %></h3>
          <div>
            <% if current_user %>
              <% if current_user.favorites.exists?(game: @game) %>
                <%= link_to game_favorite_path(@game), method: :delete, class: "btn btn-favorite-d-custom-show" do %>
                  お気に入り登録済み <i class="fa-solid fa-heart"></i>
                <% end %>
              <% else %>
                <%= link_to game_favorites_path(@game), method: :post, class: "btn btn-favorite-custom-show" do %>
                  お気に入り登録済み <i class="fa-regular fa-heart"></i>
                <% end %>
              <% end %>
            <% end %>
          </div>
          <table class="table game-date-table">
            <tbody>
              <tr>
                <th>ジャンル</th>
                <td><%= @game.genre %></td>
              </tr>
              <tr>
                <th>対応機種</th>
                <td><%= @game.status %></td>
              </tr>
              <tr>
                <th>価格</th>
                <td><%= @game.price %>円</td>
              </tr>
              <tr>
                <th>開発元</th>
                <td><%= @game.developer %></td>
              </tr>
              <tr>
                <th>リリース日</th>
                <td><%= @game.release_date %></td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>

      <div class="col-md-6">
        <section class="review-show section-back mt-3">
          <h3 class="font-al">
            <%= link_to game_path(@game), class:'btn btn-outline-dark rounded-pill btn-sm' do %>
            <i class="fa-solid fa-arrow-left"></i>
            <% end %>
            Review
          </h3>
          <div class="card m-3">
            <div class="card-body">
              <h4 class="card-title"><%= display_rating_icon(@review.rating) %></h4>
              <p class="card-text font-jp"><%= @review.comment %></p>
              <p class="pt-2"><%= attachment_image_tag @user, :profile_image, :fill, 40, 40, format: 'jpeg', fallback: "user.png", size: '40x40' %>
                <%= link_to @review.user.name, user_path(@user) %>_ <%= @review.created_at.strftime('%Y/%m/%d') %></p>
              <div class="review-update ml-auto">
                <%= link_to edit_game_review_path(@game, @review) do %>
                  編集 <i class="fa-regular fa-pen-to-square"></i>
                <% end %>
                |
                <%= link_to game_review_path(@game, @review), method: :delete, data: { confirm: "本当に削除しますか？" } do %>
                  削除 <i class="fa-solid fa-trash"></i>
                <% end %>
              </div>
            </div>
        </section>
      </div>
    </div>
  </div>
</main>